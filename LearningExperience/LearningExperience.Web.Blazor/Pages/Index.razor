@page "/"
@using LearningExperience.Web.Blazor.Models
@inject HttpClient HttpClient

<div class="sidebar">
    <NavMenu  OnBottomLevelReached="@LoadFileContentAsync" Documents="@documents" />
</div>

<div class="main">
    <div class="top-row px-4">
        <input class="form-control" type="search" placeholder="Поиск" aria-label="Search" asp-for="SearchText" style="width:100%">
    </div>

    <div class="content px-4">
        @((MarkupString)contentMarkup)       
    </div>
</div>

@code
{
    DocumentsScheme documentsScheme;

    List<Document> documents;

    string contentMarkup = "<p>Выберите тему, чтобы увидеть ее содержимое</p>";

    protected override async Task OnInitializedAsync()
    {
        documentsScheme = await HttpClient.GetFromJsonAsync<DocumentsScheme>("src\\base.json").ConfigureAwait(false);
        documents = documentsScheme.Documents;
    }

    private async Task LoadFileContentAsync(Document document)
    {
        contentMarkup = "<p class='markup'>This is a <em>markup string</em>.</p>";
        Console.WriteLine($"src/{document.Path}");
        contentMarkup = await HttpClient.GetFromJsonAsync<string>($"src\\{document.Path}").ConfigureAwait(false);
    }
}
